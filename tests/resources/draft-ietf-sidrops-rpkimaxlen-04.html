<!-- prev: draft-yossigi-rpkimaxlen --><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129d on tools.ietf.org" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-yossigi-rpkimaxlen" />
<meta name="DC.Identifier" content="urn:ietf:id:ietf-sidrops-rpkimaxlen" />
<meta name="DC.Date.Issued" content="2020-11-02" />
<meta name="DC.Creator" content="Snijders, Job" />
<meta name="DC.Creator" content="Gilad, Yossi" />
<meta name="DC.Creator" content="Maddison, Ben" />
<meta name="DC.Creator" content="Goldberg, Sharon" />
<meta name="DC.Creator" content="Sriram, Kotikalapudi" />
<meta name="DC.Description.Abstract" content="This document recommends ways to reduce forged-origin hijack attack
surface by prudently limiting the set of IP prefixes that are included
in a Route Origin Authorization (ROA). One recommendation is to avoid
using the maxLength attribute in ROAs except in some specific cases.
The recommendations complement and extend those in RFC 7115. The
document also discusses creation of ROAs for facilitating the use of
Distributed Denial of Service (DDoS) mitigation services.
Considerations related to ROAs and origin validation in the context of
destination-based Remote Triggered Black Hole (RTBH) filtering are
also highlighted." />
<meta name="DC.Title" content="The Use of Maxlength in the RPKI" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-ietf-sidrops-rpkimaxlen-04 - The Use of Maxlength in the RPKI</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<!-- draftname: draft-ietf-sidrops-rpkimaxlen-04 --><span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/id/draft-ietf-sidrops-rpkimaxlen-04.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-ietf-sidrops-rpkimaxlen-04.txt" title="PDF version of this document">pdf</a>] [<a href='https://datatracker.ietf.org/doc/draft-ietf-sidrops-rpkimaxlen' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="../wg/sidrops" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-sidrops-rpkimaxlen@ietf.org?subject=draft-ietf-sidrops-rpkimaxlen%20" title="Send email to the document authors">Email</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-sidrops-rpkimaxlen-04.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=draft-ietf-sidrops-rpkimaxlen-04.txt" title="Side-by-side diff">Diff2</a>] [<a href="/idnits?url=https://tools.ietf.org/id/draft-ietf-sidrops-rpkimaxlen-04.txt" title="Run an idnits check of this document">Nits</a>]          </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: (<a href="./draft-yossigi-rpkimaxlen" title="Precursor">draft-yossigi-rpkimaxlen</a>) <a href="./draft-ietf-sidrops-rpkimaxlen-00">00</a> <a href="./draft-ietf-sidrops-rpkimaxlen-01">01</a> <a href="./draft-ietf-sidrops-rpkimaxlen-02">02</a>                           
          <a href="./draft-ietf-sidrops-rpkimaxlen-03">03</a> <a href="./draft-ietf-sidrops-rpkimaxlen-04">04</a> <a href="./draft-ietf-sidrops-rpkimaxlen-05">05</a>                                                      </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                           Y. Gilad
Internet-Draft                            Hebrew University of Jerusalem
Intended status: Best Current Practice                       S. Goldberg
Expires: November 10, 2020                             Boston University
                                                               K. Sriram
                                                                USA NIST
                                                             J. Snijders
                                                                     NTT
                                                             B. Maddison
                                               Workonline Communications
                                                             May 9, 2020


                    <span class="h1">The Use of Maxlength in the RPKI</span>
                    <span class="h1">draft-ietf-sidrops-rpkimaxlen-04</span>

Abstract

   This document recommends ways to reduce forged-origin attack surface
   by prudently limiting the address space that is included in Route
   Origin Authorizations (ROAs).  One recommendation is to avoid using
   the maxLength attribute in ROAs except in some specific cases.  The
   recommendations complement and extend those in <a href="./rfc7115">RFC 7115</a>.  The
   document also discusses creation of ROAs for facilitating Distributed
   Denial of Service (DDoS) mitigation services.  Considerations related
   to ROAs and origin validation for the case of destination-based
   Remote Triggered Black Hole (RTBH) filtering are also highlighted.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="./bcp78">BCP 78</a> and <a href="./bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 10, 2020.







<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Requirements  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Documentation Prefixes  . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Suggested Reading . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Forged-Origin Subprefix Hijack  . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  Measurements of Today's RPKI  . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Recommendations about Minimal ROAs and Maxlength  . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.1">5.1</a>.  Creation of ROAs Facilitating DDoS Mitigation Service . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  ROAs and Origin Validation for RTBH Filtering Scenario  . . .   <a href="#page-9">9</a>
   <a href="#section-7">7</a>.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-8">8</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-8.1">8.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-8.2">8.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   The RPKI [<a href="./rfc6480" title="&quot;An Infrastructure to Support Secure Internet Routing&quot;">RFC6480</a>] uses Route Origin Authorizations (ROAs) to create
   a cryptographically verifiable mapping from an IP prefix to a set of
   autonomous systems (ASes) that are authorized to originate this
   prefix.  Each ROA contains a set of IP prefixes, and an AS number of
   an AS authorized to originate all the IP prefixes in the set
   [<a href="./rfc6482" title="&quot;A Profile for Route Origin Authorizations (ROAs)&quot;">RFC6482</a>].  The ROA is cryptographically signed by the party that
   holds a certificate for the set of IP prefixes.

   The ROA format also supports a maxLength attribute.  According to
   [<a href="./rfc6482" title="&quot;A Profile for Route Origin Authorizations (ROAs)&quot;">RFC6482</a>], "When present, the maxLength specifies the maximum length
   of the IP address prefix that the AS is authorized to advertise."
   Thus, rather than requiring the ROA to list each prefix the AS is
   authorized to originate, the maxLength attribute provides a shorthand
   that authorizes an AS to originate a set of IP prefixes.



<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


   However, measurements of current RPKI deployments have found that use
   of the maxLength in ROAs tends to lead to security problems.
   Specifically, measurements have shown that 84% of the prefixes
   specified in ROAs that use the maxLength attribute, are vulnerable to
   a forged-origin subprefix hijack [<a href="#ref-HARMFUL" title="&quot;MaxLength Considered Harmful to the RPKI&quot;">HARMFUL</a>].  The forged-origin prefix
   or subprefix hijack involves inserting the legitimate AS (as
   specified in the ROA) as the origin AS, and can be launched against
   any IP prefix/subprefix that has a ROA.  Consider a prefix/subprefix
   that has a ROA but is unused, i.e., not announced in BGP by a
   legitimate AS.  A forged-origin hijack involving such a prefix/
   subprefix can propagate widely throughout the Internet.  On the other
   hand, if the prefix/subprefix were announced by the legitimate AS,
   then the propagation of the forged-origin hijack is somewhat limited
   because of its increased path length relative to the legitimate
   announcement.  Of course, forged-origin hijacks are harmful in both
   cases but the extent of harm is greater for unannounced prefixes.

   For this reason, this document recommends that, whenever possible,
   operators SHOULD use "minimal ROAs" that include only those IP
   prefixes that are actually originated in BGP, and no other prefixes.
   Further, it recommends ways to reduce forged-origin attack surface by
   prudently limiting the address space that is included in Route Origin
   Authorizations (ROAs).  One recommendation is to avoid using the
   maxLength attribute in ROAs except in some specific cases.  The
   recommendations complement and extend those in [<a href="./rfc7115" title="&quot;Origin Validation Operation Based on the Resource Public Key Infrastructure (RPKI)&quot;">RFC7115</a>].  The
   document also discusses creation of ROAs for facilitating Distributed
   Denial of Service (DDoS) mitigation services.  Considerations related
   to ROAs and origin validation for the case of destination-based
   Remote Triggered Black Hole (RTBH) filtering are also highlighted.

   One ideal place to implement the ROA related recommendations is in
   the user interfaces for configuring ROAs.  Thus, this document
   further recommends that designers and/or providers of such user
   interfaces SHOULD provide warnings to draw the user's attention to
   the risks of using the maxLength attribute.

   Best current practices described in this document require no changes
   to the RPKI specification and will not increase the number of signed
   ROAs in the RPKI, because ROAs already support lists of IP prefixes
   [<a href="./rfc6482" title="&quot;A Profile for Route Origin Authorizations (ROAs)&quot;">RFC6482</a>].

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Requirements</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].





<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Documentation Prefixes</span>

   The documentation prefixes recommended in [<a href="./rfc5737">RFC5737</a>] are insufficient
   for use as example prefixes in this document.  Therefore, this
   document uses [<a href="./rfc1918" title="&quot;Address Allocation for Private Internets&quot;">RFC1918</a>] address space for constructing example
   prefixes.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Suggested Reading</span>

   It is assumed that the reader understands BGP [<a href="./rfc4271" title="&quot;A Border Gateway Protocol 4 (BGP-4)&quot;">RFC4271</a>], RPKI
   [<a href="./rfc6480" title="&quot;An Infrastructure to Support Secure Internet Routing&quot;">RFC6480</a>], Route Origin Authorizations (ROAs) [<a href="./rfc6482" title="&quot;A Profile for Route Origin Authorizations (ROAs)&quot;">RFC6482</a>], RPKI-based
   Prefix Validation [<a href="./rfc6811" title="&quot;BGP Prefix Origin Validation&quot;">RFC6811</a>], and BGPsec [<a href="./rfc8205" title="&quot;BGPsec Protocol Specification&quot;">RFC8205</a>].

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Forged-Origin Subprefix Hijack</span>

   A detailed description and discussion of forged-origin subprefix
   hijack are presented here, especially considering the case when the
   subprefix is not announced in BGP.  The forged-origin subprefix
   hijack is relevant to a scenario in which (1) the RPKI [<a href="./rfc6480" title="&quot;An Infrastructure to Support Secure Internet Routing&quot;">RFC6480</a>] is
   deployed, and (2) routers use RPKI origin validation to drop invalid
   routes [<a href="./rfc6811" title="&quot;BGP Prefix Origin Validation&quot;">RFC6811</a>], but (3) BGPsec [<a href="./rfc8205" title="&quot;BGPsec Protocol Specification&quot;">RFC8205</a>] (or any similar method to
   validate the truthfulness of the BGP AS_PATH attribute) is not
   deployed.

   The forged-origin subprefix hijack [<a href="./rfc7115" title="&quot;Origin Validation Operation Based on the Resource Public Key Infrastructure (RPKI)&quot;">RFC7115</a>] [<a href="#ref-GCHSS" title="&quot;Are We There Yet? On RPKI's Deployment and Security&quot;">GCHSS</a>] is described
   here using a running example.

   Consider the IP prefix 192.168.0.0/16 which is allocated to an
   organization that also operates AS 64496.  In BGP, AS 64496
   originates the IP prefix 192.168.0.0/16 as well as its subprefix
   192.168.225.0/24.  Therefore, the RPKI should contain a ROA
   authorizing AS 64496 to originate these two IP prefixes.  That is,
   the ROA should be

      ROA:(192.168.0.0/16, 192.168.225.0/24, AS 64496)

   This ROA is "minimal" because it includes only those IP prefixes that
   AS 64496 originates in BGP, but no other IP prefixes [<a href="./rfc6907" title="&quot;Use Cases and Interpretations of Resource Public Key Infrastructure (RPKI) Objects for Issuers and Relying Parties&quot;">RFC6907</a>].

   Now suppose an attacking AS 64511 originates a BGP announcement for a
   subprefix 192.168.0.0/24.  This is a standard "subprefix hijack".

   In the absence of the minimal ROA above, AS 64511 could intercept
   traffic for the addresses in 192.168.0.0/24.  This is because routers
   perform a longest-prefix match when deciding where to forward IP
   packets, and 192.168.0.0/24 originated by AS 64511 is a longer prefix
   than 192.168.0.0/16 originated by AS 64496.




<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


   However, the minimal ROA renders AS 64511's BGP announcement invalid,
   because (1) this ROA "covers" the attacker's announcement (since
   192.168.0.0/24 is a subprefix of 192.168.0.0/16), and (2) there is no
   ROA "matching" the attacker's announcement (there is no ROA for AS
   64511 and IP prefix 192.168.0.0/24) [<a href="./rfc6811" title="&quot;BGP Prefix Origin Validation&quot;">RFC6811</a>].  If routers ignore
   invalid BGP announcements, the minimal ROA above ensures that the
   subprefix hijack will fail.

   Now suppose that the "minimal ROA" was replaced with a "loose ROA"
   that used maxLength as a shorthand for set of IP prefixes that AS
   64496 is authorized to originate.  The "loose ROA" would be:

      ROA:(192.168.0.0/16-24, AS 64496)

   This "loose ROA" authorizes AS 64496 to originate any subprefix of
   192.168.0.0/16, up to length /24.  That is, AS 64496 could originate
   192.168.225.0/24 as well as all of 192.168.0.0/17, 192.168.128.0/17,
   ..., 192.168.255.0/24 but not 192.168.0.0/25.

   However, AS 64496 only originates two prefixes in BGP: 192.168.0.0/16
   and 192.168.255.0/24.  This means that all other prefixes authorized
   by the "loose ROA" (for instance, 192.168.0.0/24), are vulnerable to
   the following forged-origin subprefix hijack [<a href="./rfc7115" title="&quot;Origin Validation Operation Based on the Resource Public Key Infrastructure (RPKI)&quot;">RFC7115</a>] [<a href="#ref-GCHSS" title="&quot;Are We There Yet? On RPKI's Deployment and Security&quot;">GCHSS</a>]:

      The hijacker AS 64511 sends a BGP announcement "192.168.0.0/24: AS
      64511, AS 64496", falsely claiming that AS 64511 is a neighbor of
      AS 64496 and falsely claiming that AS 64496 originates the IP
      prefix 192.168.0.0/24.  In fact, the IP prefix 192.168.0.0/24 is
      not originated by AS 64496.

   The hijacker's BGP announcement is valid according to the RPKI, since
   the ROA (192.168.0.0/16-24, AS 64496) authorizes AS 64496 to
   originate BGP routes for 192.168.0.0/24.  Because AS 64496 does not
   actually originate a route for 192.168.0.0/24, the hijacker's route
   is the *only* route to the 192.168.0.0/24.  Longest-prefix-match
   routing ensures that the hijacker's route to the subprefix
   192.168.0.0/24 is always preferred over the legitimate route to
   192.168.0.0/16 originated by AS 64496.  Thus, the hijacker's route
   propagates through the Internet, the traffic destined for IP
   addresses in 192.168.0.0/24 will be delivered to the hijacker.

   The forged-origin *subprefix* hijack would have failed if the
   "minimal ROA" described above was used instead of the "loose ROA".
   If the "minimal ROA" had been used instead, the attacker would be
   forced to launch a forged-origin *prefix* hijack in order to attract
   traffic, as follows:





<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


      The hijacker AS 64511 sends a BGP announcement "192.168.0.0/16: AS
      64511, AS 64496", falsely claiming that AS 64511 is a neighbor of
      AS 64496.

   This forged-origin *prefix* hijack is significantly less damaging
   than the forged-origin *subprefix* hijack.  AS 64496 legitimately
   originates 192.168.0.0/16 in BGP, so the hijacker AS 64511 is not
   presenting the *only* route to 192.168.0.0/16.  Moreover, the path
   originated by AS 64511 is one hop longer than the path originated by
   the legitimate origin AS 64496.  As discussed in [<a href="#ref-LSG16" title="&quot;Rethinking Security for Internet Routing&quot;">LSG16</a>], this means
   that the hijacker will attract less traffic than he would have in the
   forged-origin *subprefix* hijack, where the hijacker presents the
   *only* route to the hijacked subprefix.

   In summary, a forged-origin subprefix hijack has the same impact as a
   regular subprefix hijack.  A forged-origin *subprefix* hijack is also
   more damaging than forged-origin *prefix* hijack.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Measurements of Today's RPKI</span>

   Network measurements have shown that 12% of the IP prefixes
   authorized in ROAs have a maxLength longer than their prefix length.
   The vast majority of these (84%) are vulnerable to forged-origin
   subprefix hijacks.  These subprefixes are not announced in BGP by the
   legitimate AS.  Even large providers are vulnerable to these attacks.
   See [<a href="#ref-GSG17" title="&quot;Maxlength Considered Harmful to the RPKI&quot;">GSG17</a>] for details.

   These measurements suggest that operators commonly misconfigure the
   maxLength attribute, and unwittingly open themselves up to forged-
   origin subprefix hijacks.  That is, they are exposing a much larger
   attack surface for forged-origin hijacks than necessary.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Recommendations about Minimal ROAs and Maxlength</span>

   Operators SHOULD avoid using the maxLength attribute in their ROAs
   except in some special cases.  One such exception may be when all
   more specific prefixes permitted by the maxLength are actually
   announced by the AS in the ROA.  Another exception for use of
   maxLength is when (a) the maxLength is substantially larger compared
   to the specified prefix length in the ROA, and (b) a large number of
   more specific prefixes in that range is announced by the AS in the
   ROA.  This case should occur rarely in practice (if at all).
   Operator discretion is necessary in this case.

   Operators SHOULD use "minimal ROAs" whenever possible.  A minimal ROA
   contains only those IP prefixes that are actually originated by an AS
   in BGP, and no other IP prefixes.  (See <a href="#section-3">Section 3</a> for an example.)




<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


   This practice requires no changes to the RPKI specification and will
   not increase the number of signed ROAs in the RPKI, because ROAs
   already support lists of IP prefixes [<a href="./rfc6482" title="&quot;A Profile for Route Origin Authorizations (ROAs)&quot;">RFC6482</a>].  See also [<a href="#ref-GSG17" title="&quot;Maxlength Considered Harmful to the RPKI&quot;">GSG17</a>] for
   further discussion of why this practice will have minimal impact on
   the performance of the RPKI ecosystem.

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Creation of ROAs Facilitating DDoS Mitigation Service</span>

   Sometimes, it is not possible to use a "minimal ROA", because an
   operator wants to issue a ROA that includes an IP prefix that is
   sometimes (but not always) originated in BGP.

   In this case, the ROA SHOULD include (1) the set of IP prefixes that
   are always originated in BGP, and (2) the set IP prefixes that are
   sometimes, but not always, originated in BGP.  The ROA SHOULD NOT
   include any IP prefixes that the operator knows will not be
   originated in BGP.  Whenever possible, the ROA SHOULD also avoid the
   use of the maxLength attribute.

   The running example is now extended to illustrate one situation where
   it is not possible to issue a minimal ROA.

   Consider the following scenario prior to deployment of RPKI.  Suppose
   AS 64496 announced 192.168.0.0/16 and has a contract with a
   Distributed Denial of Service (DDoS) mitigation service provider that
   holds AS 64500.  Further, assume that the DDoS mitigation service
   contract applies to all IP addresses covered by 192.168.0.0/22.  When
   a DDoS attack is detected and reported by AS 64496, AS 64500
   immediately originates 192.168.0.0/22, thus attracting all the DDoS
   traffic to itself.  The traffic is scrubbed at AS 64500 and then sent
   back to AS 64496 over a backhaul data link.  Notice that, during a
   DDoS attack, the DDoS mitigation service provider AS 64500 originates
   a /22 prefix that is longer than AS 64496's /16 prefix, and so all
   the traffic (destined to addresses in 192.168.0.0/22) that normally
   goes to AS 64496 goes to AS 64500 instead.

   First, suppose the RPKI only had the minimal ROA for AS 64496, as
   described in <a href="#section-3">Section 3</a>.  But if there is no ROA authorizing AS 64500
   to announce the /22 prefix, then the DDoS mitigation (and traffic
   scrubbing) scheme would not work.  That is, if AS 64500 originates
   the /22 prefix in BGP during DDoS attacks, the announcement would be
   invalid [<a href="./rfc6811" title="&quot;BGP Prefix Origin Validation&quot;">RFC6811</a>].

   Therefore, the RPKI should have two ROAs: one for AS 64496 and one
   for AS 64500.

      ROA:(192.168.0.0/16, 192.168.225.0/24, AS 64496)




<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


      ROA:(192.168.0.0/22, AS 64500)

   Neither ROA uses the maxLength attribute.  But the second ROA is not
   "minimal" because it contains a /22 prefix that is not originated by
   anyone in BGP during normal operations.  The /22 prefix is only
   originated by AS 64500 as part of its DDoS mitigation service during
   a DDoS attack.

   Notice, however, that this scheme does not come without risks.
   Namely, all IP addresses in 192.168.0.0/22 are vulnerable to a
   forged-origin subprefix hijack during normal operations, when the /22
   prefix is not originated.  (The hijacker AS 64511 would send the BGP
   announcement "192.168.0.0/22: AS 64511, AS 64500", falsely claiming
   that AS 64511 is a neighbor of AS 64500 and falsely claiming that AS
   64500 originates 192.168.0.0/22.)

   In some situations, the DDoS mitigation service at AS 64500 might
   want to limit the amount of DDoS traffic that it attracts and scrubs.
   Suppose that a DDoS attack only targets IP addresses in
   192.168.0.0/24.  Then, the DDoS mitigation service at AS 64500 only
   wants to attract the traffic designated for the /24 prefix that is
   under attack, but not the entire /22 prefix.  To allow for this, the
   RPKI should have two ROAs: one for AS 64496 and one for AS 64500.

      ROA:(192.168.0.0/16, 192.168.225.0/24, AS 64496)

      ROA:(192.168.0.0/22-24, AS 64500)

   The second ROA uses the maxLength attribute because it is designed to
   explicitly enable AS 64500 to originate *any* /24 subprefix of
   192.168.0.0/22.

   As before, the second ROA is not "minimal" because it contains
   prefixes that are not originated by anyone in BGP during normal
   operations.  As before, all IP addresses in 192.168.0.0/22 are
   vulnerable to a forged-origin subprefix hijack during normal
   operations, when the /22 prefix is not originated.

   The use of maxLength in this second ROA also comes with an additional
   risk.  While it permits the DDoS mitigation service at AS 64500 to
   originate prefix 192.168.0.0/24 during a DDoS attack in that space,
   it also makes the *other* /24 prefixes covered by the /22 prefix
   (i.e., 192.168.1.0/24, 192.168.2.0/24, 192.168.3.0/24) vulnerable to
   a forged-origin subprefix attacks.

   There is another entirely different way of managing ROAs for DDoS
   mitigation service.  In this scheme, ROAs are not pre-created for the
   DDoS mitigation service but are created on the fly when the DDoS



<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


   mitigation service request is made.  Further, the BGP announcements
   for actuating the DDoS mitigation service will not be made until the
   ROAs propagate fully through the RPKI system.  Hence, there would be
   a latency involved in DDoS mitigation service going into effect.
   This method would be effective only if the latency is guaranteed to
   be within some acceptable limit.  This calls for mechanisms to be in
   place for RPKI data propagation to occur very fast.  Thus, this
   scheme of managing ROAs for DDoS mitigation service helps with
   eliminating the attack surface for prefixes requiring this service.
   However, the viability of this scheme depends on future work related
   to achieving fast ROA propagation in the global RPKI system.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  ROAs and Origin Validation for RTBH Filtering Scenario</span>

   Considerations related to ROAs and origin validation [<a href="./rfc6811" title="&quot;BGP Prefix Origin Validation&quot;">RFC6811</a>] for
   the case of destination-based Remote Triggered Black Hole (RTBH)
   filtering are addressed here.  In RTBH filtering, highly specific
   prefixes (greater than /24 in IPv4 and greater than /48 in IPv6;
   possibly even /32 (IPv4) and /128 (IPv6)) are announced in BGP.
   These announcements are tagged with a BLACKHOLE Community [<a href="./rfc7999" title="&quot;BLACKHOLE Community&quot;">RFC7999</a>].
   It is obviously not desirable to use large maxlength or include any
   such highly specific prefixes in the ROAs to accommodate destination-
   based RTBH filtering.  Therefore, operators SHOULD accommodate this
   scenario by accepting BGP announcements tagged with BLACKHOLE
   Community only if the following conditions are met: (1) the
   announcement is received on a BGP session on which there is agreement
   to accept BLACKHOLE Community, and (2) the origin AS number in the
   announcement matches the neighbor (customer) AS number associated
   with the BGP session, and (3) the prefix in the announcement is
   subsumed by a less-specific prefix that the neighbor (customer) AS is
   authorized to announce per RPKI/ROA.  Additional details can be found
   in Section 5.5 in [<a href="#ref-NIST-800-189" title="&quot;Resilient Interdomain Traffic Exchange: BGP Security and DDoS Mitigation&quot;">NIST-800-189</a>].

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Acknowledgments</span>

   The authors would like to thank the following people for their review
   and contributions to this document: Omar Sagga (Boston University)
   and Aris Lambrianidis (AMS-IX).  Thanks are also due to Matthias
   Waehlisch (Free University of Berlin) for comments and suggestions.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  References</span>

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Normative References</span>

   [<a name="ref-RFC1918" id="ref-RFC1918">RFC1918</a>]  Rekhter, Y., Moskowitz, B., Karrenberg, D., de Groot, G.,
              and E. Lear, "Address Allocation for Private Internets",
              <a href="./bcp5">BCP 5</a>, <a href="./rfc1918">RFC 1918</a>, DOI 10.17487/RFC1918, February 1996,
              &lt;<a href="https://www.rfc-editor.org/info/rfc1918">https://www.rfc-editor.org/info/rfc1918</a>&gt;.



<span class="grey">Gilad, et al.           Expires November 10, 2020               [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a name="ref-RFC4271" id="ref-RFC4271">RFC4271</a>]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A
              Border Gateway Protocol 4 (BGP-4)", <a href="./rfc4271">RFC 4271</a>,
              DOI 10.17487/RFC4271, January 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;.

   [<a name="ref-RFC6480" id="ref-RFC6480">RFC6480</a>]  Lepinski, M. and S. Kent, "An Infrastructure to Support
              Secure Internet Routing", <a href="./rfc6480">RFC 6480</a>, DOI 10.17487/RFC6480,
              February 2012, &lt;<a href="https://www.rfc-editor.org/info/rfc6480">https://www.rfc-editor.org/info/rfc6480</a>&gt;.

   [<a name="ref-RFC6482" id="ref-RFC6482">RFC6482</a>]  Lepinski, M., Kent, S., and D. Kong, "A Profile for Route
              Origin Authorizations (ROAs)", <a href="./rfc6482">RFC 6482</a>,
              DOI 10.17487/RFC6482, February 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6482">https://www.rfc-editor.org/info/rfc6482</a>&gt;.

   [<a name="ref-RFC6811" id="ref-RFC6811">RFC6811</a>]  Mohapatra, P., Scudder, J., Ward, D., Bush, R., and R.
              Austein, "BGP Prefix Origin Validation", <a href="./rfc6811">RFC 6811</a>,
              DOI 10.17487/RFC6811, January 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;.

<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Informative References</span>

   [<a name="ref-GCHSS" id="ref-GCHSS">GCHSS</a>]    Gilad, Y., Cohen, A., Herzberg, A., Schapira, M., and H.
              Shulman, "Are We There Yet? On RPKI's Deployment and
              Security", in NDSS 2017, February 2017,
              &lt;<a href="https://eprint.iacr.org/2016/1010.pdf">https://eprint.iacr.org/2016/1010.pdf</a>&gt;.

   [<a name="ref-GSG17" id="ref-GSG17">GSG17</a>]    Gilad, Y., Sagga, O., and S. Goldberg, "Maxlength
              Considered Harmful to the RPKI", in ACM CoNEXT 2017,
              December 2017, &lt;<a href="https://eprint.iacr.org/2016/1015.pdf">https://eprint.iacr.org/2016/1015.pdf</a>&gt;.

   [<a name="ref-HARMFUL" id="ref-HARMFUL">HARMFUL</a>]  Gilad, Y., Sagga, O., and S. Goldberg, "MaxLength
              Considered Harmful to the RPKI", 2017,
              &lt;<a href="https://eprint.iacr.org/2016/1015.pdf">https://eprint.iacr.org/2016/1015.pdf</a>&gt;.

   [<a name="ref-LSG16" id="ref-LSG16">LSG16</a>]    Lychev, R., Shapira, M., and S. Goldberg, "Rethinking
              Security for Internet Routing", in Communications of the
              ACM, October 2016, &lt;<a href="http://cacm.acm.org/magazines/2016/10/207763-rethinking-security-for-internet-routing/">http://cacm.acm.org/</a>
              <a href="http://cacm.acm.org/magazines/2016/10/207763-rethinking-security-for-internet-routing/">magazines/2016/10/207763-rethinking-security-for-internet-</a>
              <a href="http://cacm.acm.org/magazines/2016/10/207763-rethinking-security-for-internet-routing/">routing/</a>&gt;.







<span class="grey">Gilad, et al.           Expires November 10, 2020              [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


   [<a name="ref-NIST-800-189" id="ref-NIST-800-189">NIST-800-189</a>]
              Sriram, K. and D. Montgomery, "Resilient Interdomain
              Traffic Exchange: BGP Security and DDoS Mitigation", NIST
              Special Publication, NIST SP 800-189, December 2019,
              &lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-189.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/</a>
              <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-189.pdf">NIST.SP.800-189.pdf</a>&gt;.

   [<a name="ref-RFC6907" id="ref-RFC6907">RFC6907</a>]  Manderson, T., Sriram, K., and R. White, "Use Cases and
              Interpretations of Resource Public Key Infrastructure
              (RPKI) Objects for Issuers and Relying Parties", <a href="./rfc6907">RFC 6907</a>,
              DOI 10.17487/RFC6907, March 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6907">https://www.rfc-editor.org/info/rfc6907</a>&gt;.

   [<a name="ref-RFC7115" id="ref-RFC7115">RFC7115</a>]  Bush, R., "Origin Validation Operation Based on the
              Resource Public Key Infrastructure (RPKI)", <a href="./bcp185">BCP 185</a>,
              <a href="./rfc7115">RFC 7115</a>, DOI 10.17487/RFC7115, January 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7115">https://www.rfc-editor.org/info/rfc7115</a>&gt;.

   [<a name="ref-RFC7999" id="ref-RFC7999">RFC7999</a>]  King, T., Dietzel, C., Snijders, J., Doering, G., and G.
              Hankins, "BLACKHOLE Community", <a href="./rfc7999">RFC 7999</a>,
              DOI 10.17487/RFC7999, October 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7999">https://www.rfc-editor.org/info/rfc7999</a>&gt;.

   [<a name="ref-RFC8205" id="ref-RFC8205">RFC8205</a>]  Lepinski, M., Ed. and K. Sriram, Ed., "BGPsec Protocol
              Specification", <a href="./rfc8205">RFC 8205</a>, DOI 10.17487/RFC8205, September
              2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;.

Authors' Addresses

   Yossi Gilad
   Hebrew University of Jerusalem
   Rothburg Family Buildings, Edmond J. Safra Campus
   Jerusalem  9190416
   Israel

   EMail: yossigi@cs.huji.ac.il


   Sharon Goldberg
   Boston University
   111 Cummington St, MCS135
   Boston, MA  02215
   USA

   EMail: goldbe@cs.bu.edu






<span class="grey">Gilad, et al.           Expires November 10, 2020              [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey">Internet-Draft               RPKI maxLength                     May 2020</span>


   Kotikalapudi Sriram
   USA National Institute of Standards and Technology
   100 Bureau Drive
   Gaithersburg, MD  20899
   USA

   EMail: kotikalapudi.sriram@nist.gov


   Job Snijders
   NTT Communications
   Theodorus Majofskistraat 100
   Amsterdam  1065 SZ
   The Netherlands

   EMail: job@ntt.net


   Ben Maddison
   Workonline Communications
   30 Waterkant St
   Cape Town  8001
   South Africa

   EMail: benm@workonline.co.za


























Gilad, et al.           Expires November 10, 2020              [Page 12]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129d, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>
</html>
